<div class="container">
  <h1>Gestione Task</h1>

  <!-- Form per aggiungere una nuova task -->
  <form (ngSubmit)="addTask()" #taskForm="ngForm">
    <div class="form-group">
      <label for="titolo">Titolo</label>
      <input
        type="text"
        id="titolo"
        class="form-control"
        [(ngModel)]="newTask.titolo"
        name="titolo"
        required
      />
    </div>

    <div class="form-group">
      <label for="descrizione">Descrizione</label>
      <textarea
        id="descrizione"
        class="form-control"
        [(ngModel)]="newTask.descrizione"
        name="descrizione"
        required
      ></textarea>
    </div>

    <div class="form-group">
      <label for="dataInizio">Data Inizio</label>
      <input
        type="date"
        id="dataInizio"
        class="form-control"
        [(ngModel)]="newTask.dataInizio"
        name="dataInizio"
        required
      />
    </div>
    
    <div class="form-group">
      <label for="dataFine">Data Fine</label>
      <input
        type="date"
        id="dataFine"
        class="form-control"
        [(ngModel)]="newTask.dataFine"
        name="dataFine"
        required
      />
    </div>

    <div class="form-group">
      <label for="tipoLavoro">Tipo di Lavoro</label>
      <select
        id="tipoLavoro"
        class="form-control"
        [(ngModel)]="newTask.tipoLavoro"
        name="tipoLavoro"
        required
      >
        <option [value]="TipoLavoro.MENTALE">Mentale</option>
        <option [value]="TipoLavoro.FISICO">Fisico</option>
      </select>
    </div>

    <button type="submit" class="btn btn-primary">
      Aggiungi Task
    </button>
  </form>

  <hr />

  <!-- Elenco delle task -->
  <h2>Elenco Task</h2>
  <ul class="list-group">
    <li
      class="list-group-item"
      *ngFor="let task of tasks"
    >
      <h5>{{ task.titolo }}</h5>
      <p>{{ task.descrizione }}</p>
      <p><strong>Data Inizio:</strong> {{ task.dataInizio }}</p>
      <p><strong>Data Fine:</strong> {{ task.dataFine }}</p>
      <p><strong>Tipo di Lavoro:</strong> {{ task.tipoLavoro }}</p>
      <p><strong>Stato:</strong>   {{ task.risolta === true ? 'Risolto' : (task.risolta === false ? 'Non Risolto' : 'Stato Non Definito') }}</p>
      <button
        class="btn btn-danger btn-sm"
        (click)="deleteTask(task.id!)"
      >
        Elimina
      </button>
      <button
        class="btn btn-secondary btn-sm"
        (click)="toggleTaskResolved(task.id!, !task.risolta)"
      >
        {{ task.risolta ? 'Segna come Non Risolto' : 'Segna come Risolto' }}
      </button>
    </li>
  </ul>
</div>